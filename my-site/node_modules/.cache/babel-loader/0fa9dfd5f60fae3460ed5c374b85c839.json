{"remainingRequest":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\babel-loader\\lib\\index.js!E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\src\\directives\\lazy.js","dependencies":[{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\src\\directives\\lazy.js","mtime":1618420397390},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkU6L1ZVRTJcdTVCNjZcdTRFNjAvXHU2NDJEXHU1RUZBXHU1REU1XHU3QTBCL1x1NEUyQVx1NEVCQVx1NTM1QVx1NUJBMlx1OTg3OVx1NzZFRS9teS1zaXRlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0IGV2ZW50QnVzIGZyb20gIkAvZXZlbnRCdXMiOwppbXBvcnQgeyBkZWJvdW5jZSB9IGZyb20gIkAvdXRpbHMiOwppbXBvcnQgZGVmYXVsdEdpZiBmcm9tICJAL2Fzc2V0cy9kZWZhdWx0LmdpZiI7CnZhciBpbWdzID0gW107IC8v6K6+572u5pWw57uE77yM5b6A6YeM6Z2i5Yqg6L+b5Y675Zu+54mHOwoKZnVuY3Rpb24gbGF6eUltYWdlKGltZykgewogIGltZy5kb20uc3JjID0gZGVmYXVsdEdpZjsgLy/lhYjmmoLml7bkvb/nlKjpu5jorqTlm77niYcKICAvL2NvbnNvbGUubG9nKCfliqDovb3kuoYnKTsKICAvL+WkhOeQhuWbvueJhwogIC8v6K+l5Zu+54mH5piv5ZCm5Zyo6KeG5Y+j6IyD5Zu05YaFCgogIHZhciBjbGllbnRIZWlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0OyAvL+WuueWZqOmrmOW6pgoKICB2YXIgcmVjdCA9IGltZy5kb20uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7IC8v6I635Y+W6KeG5Y+j6L+U5Zue5YC8CgogIHZhciBoZWlnaHQgPSByZWN0LmhlaWdodCB8fCAxNTA7IC8v5Y+W6KeG5Y+j6auY5bqm5oiW6ICF6buY6K6kMTUwCgogIGlmIChyZWN0LnRvcCA+PSAtaGVpZ2h0ICYmIHJlY3QudG9wIDw9IGNsaWVudEhlaWdodCkgewogICAgLy8g5Zyo6KeG5Y+j6IyD5Zu05YaFCiAgICAvLyBjb25zdCB0ZW1wSW1nID0gbmV3IEltYWdlKCk7CiAgICAvLyB0ZW1wSW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgLy8gICAvLyDlvZPnnJ/lrp7lm77niYfliqDovb3lrozmiJDkuYvlkI4KICAgIC8vICAgaW1nLmRvbS5zcmMgPSBpbWcuc3JjOwogICAgLy8gfTsKICAgIC8vIHRlbXBJbWcuc3JjID0gaW1nLnNyYzsKICAgIGltZy5kb20uc3JjID0gaW1nLnNyYzsKICAgIGltZ3MgPSBpbWdzLmZpbHRlcihmdW5jdGlvbiAoaSkgewogICAgICByZXR1cm4gaSAhPT0gaW1nOwogICAgfSk7CiAgfQp9Cgo7IC8v5biM5pyb6LCD55So6L+Z5Liq5Ye95pWw5a6e546w5Zu+54mH5oeS5Yqg6L29CgpmdW5jdGlvbiBzZXRJbWFnZXMoKSB7CiAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGltZ3MpLAogICAgICBfc3RlcDsKCiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBpbWcgPSBfc3RlcC52YWx1ZTsKICAgICAgLy/lpITnkIbor6Xlm77niYcKICAgICAgbGF6eUltYWdlKGltZyk7CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfaXRlcmF0b3IuZShlcnIpOwogIH0gZmluYWxseSB7CiAgICBfaXRlcmF0b3IuZigpOwogIH0KfQoKZnVuY3Rpb24gZGVib3VuY2VTY3JvbGwoKSB7CiAgc2V0SW1hZ2VzKCk7Cn0KCjsgLy8gc2V0SW50ZXJ2YWwoKCkgPT57ICAvL+a1i+ivleS4gOS4i+WKoOi/m+adpeeahOWbvueJhwovLyAgIGNvbnNvbGUubG9nKGltZ3MpOwovLyB9LCAyMDAwKQoKZXZlbnRCdXMuJG9uKCdtYWluU2Nyb2xsJywgZGVib3VuY2UoZGVib3VuY2VTY3JvbGwsIDUwKSk7CmV4cG9ydCBkZWZhdWx0IHsKICBpbnNlcnRlZDogZnVuY3Rpb24gaW5zZXJ0ZWQoZWwsIGJpbmRpbmcpIHsKICAgIHZhciBpbWcgPSB7CiAgICAgIGRvbTogZWwsCiAgICAgIHNyYzogYmluZGluZy52YWx1ZQogICAgfTsKICAgIGltZ3MucHVzaChpbWcpOyAvLyDnq4vljbPlpITnkIblroMKCiAgICBsYXp5SW1hZ2UoaW1nKTsKICB9LAogIHVuYmluZDogZnVuY3Rpb24gdW5iaW5kKGVsKSB7CiAgICBpbWdzID0gaW1ncy5maWx0ZXIoZnVuY3Rpb24gKGltZykgewogICAgICByZXR1cm4gaW1nLmRvbSAhPT0gZWw7CiAgICB9KTsKICB9Cn07"},{"version":3,"sources":["E:/VUE2学习/搭建工程/个人博客项目/my-site/src/directives/lazy.js"],"names":["eventBus","debounce","defaultGif","imgs","lazyImage","img","dom","src","clientHeight","document","documentElement","rect","getBoundingClientRect","height","top","filter","i","setImages","debounceScroll","$on","inserted","el","binding","value","push","unbind"],"mappings":";;AAAA,OAAOA,QAAP,MAAqB,YAArB;AACA,SAASC,QAAT,QAAyB,SAAzB;AACA,OAAOC,UAAP,MAAuB,sBAAvB;AAEA,IAAIC,IAAI,GAAG,EAAX,C,CAAe;;AAGf,SAASC,SAAT,CAAmBC,GAAnB,EAAuB;AACnBA,EAAAA,GAAG,CAACC,GAAJ,CAAQC,GAAR,GAAcL,UAAd,CADmB,CACM;AAC5B;AACA;AACA;;AACA,MAAMM,YAAY,GAAGC,QAAQ,CAACC,eAAT,CAAyBF,YAA9C,CALsB,CAKuC;;AAC7D,MAAOG,IAAI,GAAGN,GAAG,CAACC,GAAJ,CAAQM,qBAAR,EAAd,CANsB,CAMwB;;AAC9C,MAAMC,MAAM,GAAGF,IAAI,CAACE,MAAL,IAAe,GAA9B,CAPsB,CAOc;;AACpC,MAAGF,IAAI,CAACG,GAAL,IAAY,CAACD,MAAb,IAAuBF,IAAI,CAACG,GAAL,IAAYN,YAAtC,EAAmD;AAC7C;AACH;AACA;AACA;AACA;AACA;AACA;AACAH,IAAAA,GAAG,CAACC,GAAJ,CAAQC,GAAR,GAAcF,GAAG,CAACE,GAAlB;AACAJ,IAAAA,IAAI,GAAGA,IAAI,CAACY,MAAL,CAAY,UAACC,CAAD;AAAA,aAAOA,CAAC,KAAKX,GAAb;AAAA,KAAZ,CAAP;AACF;AACD;;AAAA,C,CACD;;AACA,SAASY,SAAT,GAAoB;AAAA,6CACCd,IADD;AAAA;;AAAA;AAChB,wDAAsB;AAAA,UAAZE,GAAY;AAClB;AACAD,MAAAA,SAAS,CAACC,GAAD,CAAT;AACH;AAJe;AAAA;AAAA;AAAA;AAAA;AAKnB;;AAED,SAASa,cAAT,GAAyB;AACrBD,EAAAA,SAAS;AAEZ;;AAAA,C,CAED;AACA;AACA;;AAEAjB,QAAQ,CAACmB,GAAT,CAAa,YAAb,EAA2BlB,QAAQ,CAACiB,cAAD,EAAiB,EAAjB,CAAnC;AAEA,eAAe;AACZE,EAAAA,QADY,oBACHC,EADG,EACCC,OADD,EACS;AACjB,QAAMjB,GAAG,GAAG;AACXC,MAAAA,GAAG,EAAEe,EADM;AAEXd,MAAAA,GAAG,EAAEe,OAAO,CAACC;AAFF,KAAZ;AAICpB,IAAAA,IAAI,CAACqB,IAAL,CAAUnB,GAAV,EALgB,CAMhB;;AACAD,IAAAA,SAAS,CAACC,GAAD,CAAT;AACJ,GATW;AAUZoB,EAAAA,MAVY,kBAULJ,EAVK,EAUF;AACNlB,IAAAA,IAAI,GAAGA,IAAI,CAACY,MAAL,CAAY,UAACV,GAAD;AAAA,aAASA,GAAG,CAACC,GAAJ,KAAYe,EAArB;AAAA,KAAZ,CAAP;AACH;AAZW,CAAf","sourcesContent":["import eventBus from \"@/eventBus\";\r\nimport { debounce } from \"@/utils\";\r\nimport defaultGif from \"@/assets/default.gif\";\r\n\r\nlet imgs = []; //设置数组，往里面加进去图片;\r\n\r\n\r\nfunction lazyImage(img){\r\n    img.dom.src = defaultGif;//先暂时使用默认图片\r\n //console.log('加载了');\r\n //处理图片\r\n //该图片是否在视口范围内\r\n const clientHeight = document.documentElement.clientHeight;  //容器高度\r\n const  rect = img.dom.getBoundingClientRect();//获取视口返回值\r\n const height = rect.height || 150;  //取视口高度或者默认150\r\n if(rect.top >= -height && rect.top <= clientHeight){\r\n       // 在视口范围内\r\n    // const tempImg = new Image();\r\n    // tempImg.onload = function() {\r\n    //   // 当真实图片加载完成之后\r\n    //   img.dom.src = img.src;\r\n    // };\r\n    // tempImg.src = img.src;\r\n    img.dom.src = img.src;\r\n    imgs = imgs.filter((i) => i !== img)\r\n }\r\n};\r\n//希望调用这个函数实现图片懒加载\r\nfunction setImages(){\r\n    for(const img of imgs){\r\n        //处理该图片\r\n        lazyImage(img);\r\n    }\r\n}\r\n\r\nfunction debounceScroll(){\r\n    setImages()\r\n  \r\n};\r\n\r\n// setInterval(() =>{  //测试一下加进来的图片\r\n//   console.log(imgs);\r\n// }, 2000)\r\n\r\neventBus.$on('mainScroll', debounce(debounceScroll, 50))\r\n\r\nexport default {\r\n   inserted(el, binding){  \r\n       const img = {\r\n        dom: el,\r\n        src: binding.value,\r\n       };\r\n        imgs.push(img);\r\n        // 立即处理它\r\n        lazyImage(img);\r\n   },\r\n   unbind(el){\r\n       imgs = imgs.filter((img) => img.dom !== el);\r\n   }\r\n}\r\n"]}]}