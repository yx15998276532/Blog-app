{"remainingRequest":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\thread-loader\\dist\\cjs.js!E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\babel-loader\\lib\\index.js!E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\src\\views\\Blog\\components\\BlogComment.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\src\\views\\Blog\\components\\BlogComment.vue","mtime":1618903092847},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRTovVlVFMlx1NUI2Nlx1NEU2MC9cdTY0MkRcdTVFRkFcdTVERTVcdTdBMEIvXHU0RTJBXHU0RUJBXHU1MzVBXHU1QkEyXHU5ODc5XHU3NkVFL215LXNpdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRTovVlVFMlx1NUI2Nlx1NEU2MC9cdTY0MkRcdTVFRkFcdTVERTVcdTdBMEIvXHU0RTJBXHU0RUJBXHU1MzVBXHU1QkEyXHU5ODc5XHU3NkVFL215LXNpdGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBNZXNzYWdlQXJlYSBmcm9tICJAL2NvbXBvbmVudHMvTWVzc2FnZUFyZWEiOwppbXBvcnQgZmV0Y2hEYXRhIGZyb20gIkAvbWl4aW5zL2ZldGNoRGF0YS5qcyI7CmltcG9ydCB7IGdldENvbW1lbnRzLCBwb3N0Q29tbWVudCB9IGZyb20gIkAvYXBpL2Jsb2cuanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbWl4aW5zOiBbZmV0Y2hEYXRhKHsKICAgIHRvdGFsOiAwLAogICAgcm93czogW10KICB9KV0sCiAgY29tcG9uZW50czogewogICAgTWVzc2FnZUFyZWE6IE1lc3NhZ2VBcmVhCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGFnZTogMSwKICAgICAgbGltaXQ6IDEwCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIC8vIHdpbmRvdy5mZXRjaE1vcmUgPSB0aGlzLmZldGNoTW9yZTsKICAgIHRoaXMuJGJ1cy4kb24oIm1haW5TY3JvbGwiLCB0aGlzLmhhbmRsZVNjb3JsbCk7CiAgfSwKICBkZXN0cm95ZWQ6IGZ1bmN0aW9uIGRlc3Ryb3llZCgpIHsKICAgIHRoaXMuJGJ1cy4kb2ZmKCJtYWluU2Nyb2xsIiwgdGhpcy5oYW5kbGVTY29ybGwpOwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGhhc01vcmU6IGZ1bmN0aW9uIGhhc01vcmUoKSB7CiAgICAgIHJldHVybiB0aGlzLmRhdGEucm93cy5sZW5ndGggPCB0aGlzLmRhdGEudG90YWw7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvL+inpuWPkea7muWKqOadoeeahOWIsOW6lemDqOS9jee9rgogICAgaGFuZGxlU2NvcmxsOiBmdW5jdGlvbiBoYW5kbGVTY29ybGwoZG9tKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGRvbSk7CiAgICAgIGlmICh0aGlzLmlzTG9hZGluZyB8fCAhZG9tKSB7CiAgICAgICAgLy/nm67liY3mraPlnKjliqDovb3mm7TlpJoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciByYW5nZSA9IDEwMDsgLy/lrprkuIDkuKrlj6/ku6XmjqXlj5fnmoTojIPlm7TvvIzlnKjov5nkuKrojIPlm7TlhoXpg73nrpfliLDovr7liLDlupXpg6gKCiAgICAgIHZhciBkZWMgPSBNYXRoLmFicyhkb20uc2Nyb2xsVG9wICsgZG9tLmNsaWVudEhlaWdodCAtIGRvbS5zY3JvbGxIZWlnaHQpOwoKICAgICAgaWYgKGRlYyA8PSByYW5nZSkgewogICAgICAgIC8vIGNvbnNvbGUubG9nKCfliqDovb3mm7TlpJonKTsKICAgICAgICB0aGlzLmZldGNoTW9yZSgpOwogICAgICB9CiAgICB9LAogICAgZmV0Y2hEYXRhOiBmdW5jdGlvbiBmZXRjaERhdGEoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldENvbW1lbnRzKF90aGlzLiRyb3V0ZS5wYXJhbXMuaWQsIF90aGlzLnBhZ2UsIF90aGlzLmxpbWl0KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQuc2VudCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICAvL+WKoOi9veS4i+S4gOmhtQogICAgZmV0Y2hNb3JlOiBmdW5jdGlvbiBmZXRjaE1vcmUoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHJlc3A7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmIChfdGhpczIuaGFzTW9yZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgX3RoaXMyLmlzTG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICBfdGhpczIucGFnZSsrOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA2OwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5mZXRjaERhdGEoKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgX3RoaXMyLmRhdGEudG90YWwgPSByZXNwLnRvdGFsOwogICAgICAgICAgICAgICAgX3RoaXMyLmRhdGEucm93cyA9IF90aGlzMi5kYXRhLnJvd3MuY29uY2F0KHJlc3Aucm93cyk7CiAgICAgICAgICAgICAgICBfdGhpczIuaXNMb2FkaW5nID0gZmFsc2U7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBoYW5kbGVTdWJtaXQ6IGZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChmb3JtRGF0YSwgY2FsbGJhY2spIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICB2YXIgcmVzcDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHBvc3RDb21tZW50KF9vYmplY3RTcHJlYWQoewogICAgICAgICAgICAgICAgICBibG9nSWQ6IF90aGlzMy4kcm91dGUucGFyYW1zLmlkCiAgICAgICAgICAgICAgICB9LCBmb3JtRGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXNwID0gX2NvbnRleHQzLnNlbnQ7CgogICAgICAgICAgICAgICAgX3RoaXMzLmRhdGEucm93cy51bnNoaWZ0KHJlc3ApOwoKICAgICAgICAgICAgICAgIF90aGlzMy5kYXRhLnRvdGFsKys7CiAgICAgICAgICAgICAgICBjYWxsYmFjaygn6K+E6K665oiQ5YqfJyk7IC8v5ZGK6K+J5a2Q57uE5Lu244CC5oiR6L+Z6L655aSE55CG5a6M5LqG77yM5L2g57un57utCgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["BlogComment.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"blog-comment-container\">\r\n    <MessageArea title=\"评论列表\" \r\n    :subTitle=\"`(${data.total})`\" \r\n    :list=\"data.rows\" :isListLoading=\"isLoading\"\r\n    @submit=\"handleSubmit\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport MessageArea from \"@/components/MessageArea\";\r\nimport fetchData from \"@/mixins/fetchData.js\";\r\nimport { getComments, postComment } from \"@/api/blog.js\";\r\nexport default {\r\n  mixins:[fetchData({total:0, rows:[]})],\r\n    components:{\r\n        MessageArea,\r\n    },\r\n    data(){\r\n      return{\r\n        page:1,\r\n        limit:10,\r\n      }\r\n    },\r\n    created(){\r\n        // window.fetchMore = this.fetchMore;\r\n        this.$bus.$on(\"mainScroll\", this.handleScorll);\r\n    },\r\n    destroyed(){\r\n      this.$bus.$off(\"mainScroll\", this.handleScorll);\r\n    },\r\n\r\n    computed:{\r\n        hasMore(){\r\n          return this.data.rows.length < this.data.total;\r\n        },\r\n    },\r\n    methods:{\r\n        //触发滚动条的到底部位置\r\n        handleScorll(dom){\r\n          // console.log(dom);\r\n          if(this.isLoading || !dom){\r\n            //目前正在加载更多\r\n                return;\r\n          }\r\n         const range = 100; //定一个可以接受的范围，在这个范围内都算到达到底部\r\n        const dec = Math.abs(dom.scrollTop + dom.clientHeight - dom.scrollHeight);\r\n        if(dec <= range){\r\n          // console.log('加载更多');\r\n          this.fetchMore();\r\n        }      \r\n        },\r\n        async fetchData(){\r\n           return await getComments(this.$route.params.id, this.page,this.limit)\r\n        }, \r\n        //加载下一页\r\n        async fetchMore(){\r\n          if(!this.hasMore){\r\n            //没有更多数据了\r\n            return;\r\n          }\r\n            this.isLoading = true;\r\n            this.page++;\r\n            const resp = await this.fetchData();\r\n              this.data.total = resp.total;\r\n              this.data.rows = this.data.rows.concat(resp.rows);\r\n              this.isLoading = false;\r\n\r\n        } ,     \r\n      async  handleSubmit(formData, callback){\r\n       const resp = await  postComment({\r\n              blogId: this.$route.params.id,\r\n              ...formData\r\n             });       \r\n             this.data.rows.unshift(resp);\r\n             this.data.total++;\r\n             callback('评论成功');//告诉子组件。我这边处理完了，你继续\r\n        }            \r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.blog-comment-container{\r\n  margin: 30px 0;\r\n}\r\n</style>"],"sourceRoot":"src/views/Blog/components"}]}