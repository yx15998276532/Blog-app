{"remainingRequest":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\src\\views\\Blog\\components\\BlogToc.vue?vue&type=style&index=0&id=38598d20&lang=less&scoped=true&","dependencies":[{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\src\\views\\Blog\\components\\BlogToc.vue","mtime":1618302869220},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\VUE2学习\\搭建工程\\个人博客项目\\my-site\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLy8gQGltcG9ydCAifkAvc3R5bGVzL3Zhci5sZXNzIjsNCi5yaWdodC1kZXRhaWwtY29udGFpbmVyew0KICBoMnsNCiAgICAgIGxldHRlci1zcGFjaW5nOiAycHg7DQogICAgICAgbWFyZ2luOiAwOw0KICB9DQogIC5saXN0ew0KICAgIGZvbnQtc2l6ZTogMWVtOw0KICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgfQ0KfQ0KICANCiAgDQo="},{"version":3,"sources":["BlogToc.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BlogToc.vue","sourceRoot":"src/views/Blog/components","sourcesContent":["<template>\r\n<div class=\"right-detail-container\">\r\n  <h2>目录</h2>\r\n  <RightList :list=\"tocWintSelect\" @select=\"handkeSelect \" class=\"list\"/>\r\n</div>\r\n \r\n</template>\r\n\r\n<script>\r\nimport RightList from \"./RightList\";\r\nimport { debounce } from \"@/utils\";\r\nexport default {\r\ncomponents:{\r\n  RightList,\r\n},\r\nprops:{\r\n  toc:{\r\n    type:Array,\r\n  }\r\n},\r\ndata(){\r\n  return{\r\n    activeAnchor:\"\",  //假设默认选中\r\n  }\r\n},\r\ncomputed:{\r\n    tocWintSelect(){\r\n      //根据toc属性以及activeAnchor得到带有isSelect属性的toc数组\r\n      const getToc = (toc = [])=> {\r\n         return toc.map( (t) =>({  //toc数组映射\r\n           ...t,\r\n           isSelect:t.anchor === this.activeAnchor,  //判断toc数组是不是和默认activeAnchor匹配\r\n           children:getToc(t.children),\r\n         }));\r\n      }; \r\n     return getToc(this.toc)\r\n\r\n    },\r\n    //根据toc 得到它们对应的元素数组\r\n  doms(){   //循环toc数据，获取id并添加到doms数组里\r\n    const doms = [];\r\n\r\n    const addToDoms = (toc) =>{\r\n        for (const t of toc) {\r\n          // console.log(t.anchor);\r\n            doms.push( document.getElementById(t.anchor));\r\n          if(t.children && t.children.length){\r\n            addToDoms(t.children)\r\n          }\r\n        }\r\n    }\r\n      addToDoms(this.toc);\r\n      return doms;\r\n  }\r\n\r\n},\r\ncreated(){\r\n// window.setSelect = this.setSelect;\r\n  this.setSelectDebounce =  debounce(this.setSelect, 50);\r\n   this.$bus.$on(\"mainScroll\", this.setSelectDebounce );\r\n},\r\ndestroyed(){\r\n  this.$bus.$off(\"mainScroll\", this.setSelectDebounce );\r\n},\r\nmethods:{\r\n  handkeSelect(item){\r\n    // console.log(item);\r\n    location.hash = item.anchor;   \r\n  },\r\n\r\n//设置activeAnchor为正确的值\r\nsetSelect(){\r\n  //console.log(1);\r\n  this.activeAnchor = \"\"; //由于后面要持续更新，先清空之前的状态\r\n  const range = 200;\r\n    for(const dom of this.doms){\r\n      //看一下这个元素是不是被选中\r\n      if(!dom){\r\n          continue;\r\n      }\r\n      \r\n      //得到元素离视口到顶部的距离\r\n      const top = dom.getBoundingClientRect().top;\r\n        if(top >= 0 && top <= range ){\r\n          //在规定范围\r\n          this.activeAnchor = dom.id;\r\n          return\r\n        }else if(top > range){\r\n            //在规定范围下方\r\n            return\r\n        } else {\r\n          // 在规定范围上方\r\n           this.activeAnchor = dom.id;  //假设自己被激活的，然后继续看后面\r\n        }\r\n    }\r\n  }\r\n }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n// @import \"~@/styles/var.less\";\r\n.right-detail-container{\r\n  h2{\r\n      letter-spacing: 2px;\r\n       margin: 0;\r\n  }\r\n  .list{\r\n    font-size: 1em;\r\n     font-weight: bold;\r\n  }\r\n}\r\n  \r\n  \r\n</style>"]}]}